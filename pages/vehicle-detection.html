<!DOCTYPE html>

<html lang="en">
    
    <head>
        <title>gderoo</title>
        <meta charset="utf-8" />
        <META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE">
            
        <link rel="stylesheet" type="text/css" href="/theme/css/bootstrap.css">
        <link rel="stylesheet" type="text/css" href="/theme/css/beemuse.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
        <link rel="stylesheet" type="text/css" href="/theme/css/base.css">
    </head>
    
    <body>
        
        <section id="navbar">
            <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
                <div class="container">
                    <div class="navbar-header">
                        <a class="navbar-brand" href="/index.html">gderoo</a>
                    </div>
                    <div class="collapse navbar-collapse">
                        <ul class="nav navbar-nav">
                            <li><a href="/pages/menu.html">Home</a></li>
                            <li><a href="/pages/about-me.html">About Me</a></li>
                            <li><a href="/pages/cv.html">CV</a></li>
                        </ul>
                    </div><!--/.nav-collapse -->
                </div>
            </div>
        </section>
        
        <br>
        <section class="content">
            <div class="row">
                
                <div class="col-xs-12 col-md-8  col-md-offset-2 col-lg-6 col-lg-offset-3">
                    
                    <div class="paper">
                        <header>
                            <h2 class="entry-title">Vehicle Detection</h2>
                            
                        </header>
                        <footer class="post-info">
                            <b>May 2017</b>
                        </footer><!-- /.post-info -->
                        <br />
                        <div class="entry-content">
                            
                            <p>This is an overview of the fith project of the Udacity nanodegreee. In this project, we
                            <ul>
                            <li> Perform a Histogram of Oriented Gradients (HOG) feature extraction (also append binned color features, as well as histograms of color) </li>
                            <li> Train a classifier Linear SVM classifier </li>
                            <li> Implement a sliding-window technique and use your trained classifier to search for vehicles in images</li>
                            </ul>
                            The result can be seen below:</p>
                            
                            <video class="center" width="320" height="240" controls autoplay loop>
                                <source src="/media/vehicle-detection/video.mov">
                                    <source src="movie.ogg" type="video/ogg">
                                        Your browser does not support the video tag.
                                        </video> <br />
                            
                            <p><b>Data Exploration</b></p>
                            
                            <p>Labeled images were taken from the GTI and the KITTI vision benchmark suite. All images are 64x64 pixels. A third data set released by Udacity was not used here. In total there are 8792 images of vehicles and 8968 images of non vehicles, so only a slight imbalance. An example can be seen below</p>
                            
                            <img class="center" src="/media/vehicle-detection/original.png">

                            <p><b>Feature Extraction</b></p>
                            
                            <p>We extracted several features adding up to 6108 features (since we start from 64*64 = 4,096 some are probably redundant):
                            <ul>
                            <li> Convert image to HLS and do a spatial binning to bring to (16,16)</li>
                            <li> Calculate color histogram with 32 bins by HLS channel</li>
                            <li> Calculate Histogram Oriented Graph (HOG) for each color channel</li>
                            </ul>
                            The result can be partially seen below for a car and non car.
                            </p>
                            
                            <img class="center" src="/media/behavioral-cloning/augmentation.png">
                            </br>
                               
                            The resulting distribution of angles is much smoother
                            
                            <img class="center" src="/media/behavioral-cloning/histo_after.png">
                            </br>
                            
                            <p><b>Neural network architecture</b></p>
                            
                            <p>For the architecture, we mostly used the architecture from a <a href="https://images.nvidia.com/content/tegra/automotive/images/2016/solutions/pdf/end-to-end-dl-using-px.pdf" target="_blank">NVIDIA paper</a> shown below. The main modifications were to:
                            <ul>
                                <li>introduce a drop out at the end of the convolutional layers</li>
                                <li>add cropping of the top and bottom of the image (car hood) before normalization</li>
                            </ul>
                            </p>
                            
                            <a href="https://images.nvidia.com/content/tegra/automotive/images/2016/solutions/pdf/end-to-end-dl-using-px.pdf" target="_blank"><img class="center" src="/media/behavioral-cloning/nvidia-architecture.png" height="300"></a>
                            </br>

                            <p>Orginally, we had used a simpler neural network with less parameters to limit overfitting. However, after the data augmentation strategy implemented above, we were able to directly implement the NVIDIA architecture which was developed to solve a similar issue.</p>
                            
                            <p><b>Training</b></p>
                            
                            <p>We used a batch size of 256, with 7 epochs and 8,192 images per epoch (i.e. 32 batches per epoch). We also implemented an image generator to optimize performance.</p>
                            
                            <p><b>Further improvement</b></p>
                            <p>We notice that the car mistakes shadows for road borders and tries to avoid them (only to steer back to the middle of the road when it arrives close to the edge). This could probably be overcome by casting random shadows on the image during the data augmentation process.</p>
                            
                            <p>Below an example in which the shadow steers the car to the right of the road:</p>
                            <img class="center" src="/media/behavioral-cloning/shadow.png">
                            <br />
                            
                            <p><a href="https://github.com/gderoo/self_driving_car/tree/master/Project%203%20-%20Behavioral%20Cloning" target="_blank">GitHub repository</a></p>


                            </div>
                        </div>
                    </div>
                </div>
            
            </section><!-- /#content -->
        
        <footer id="slidingfooter" class="body">
            Original design by Andy Reagan, modified by Guillaume De Roo
        </footer>
    </body>
    </script>
</html>
